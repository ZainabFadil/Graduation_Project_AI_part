# -*- coding: utf-8 -*-
"""main.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1ccFRY8RRgqeYZdf-AhyaS5F1EAbtjO-D
"""

from fastapi import FastAPI
from pydantic import BaseModel
import joblib
import numpy as np
import pandas as pd

# ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„ØŒ Ø§Ù„Ø³ÙƒÙŠÙ„Ø±ØŒ ÙˆØ§Ù„Ø§Ù†ÙƒÙˆØ¯Ø±Ø²
model = joblib.load("logistic_model.pkl")
scaler = joblib.load("scaler.pkl")
label_encoders = joblib.load("label_encoders.pkl")

# ØªØ¹Ø±ÙŠÙ FastAPI app
app = FastAPI(title="Startup Success Prediction API")

# ØªØ¹Ø±ÙŠÙ Ø´ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù…Ù† Ø§Ù„ÙŠÙˆØ²Ø±
class StartupData(BaseModel):
    city: str
    industry: str
    has_online_presence: int
    num_founders: int
    num_employees: int
    got_external_funding: int
    startup_stage: str
    market_competition_level: str
    incubator_support: int
    num_direct_competitors: str
    market_need_level: str
    startup_age: int

@app.post("/predict/")
def predict_startup(data: StartupData):
    # ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¯Ø§ØªØ§ Ù„Ù€ DataFrame
    input_data = pd.DataFrame([data.dict()])

    # ØªØ·Ø¨ÙŠÙ‚ Label Encoding
    for col, le in label_encoders.items():
        input_data[col] = le.transform(input_data[col])

    # Scaling
    input_scaled = scaler.transform(input_data)

    # Prediction
    prediction = model.predict(input_scaled)[0]

    # ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù„ÙƒÙ„Ø§Ù… Ù…ÙÙ‡ÙˆÙ…
    result = "Successful âœ…" if prediction == 1 else "Unsuccessful âŒ"
    return {"prediction": int(prediction), "result": result}

#How to use FASTAPI

"""
ğŸ§ª ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù€ API Ù…Ø­Ù„ÙŠÙ‹Ø§:
Ø¨Ø¹Ø¯ Ø­ÙØ¸ Ø§Ù„ÙƒÙˆØ¯ ÙÙŠ Ù…Ù„Ù Ù…Ø«Ù„Ø§Ù‹ main.pyØŒ Ø´ØºÙ‘Ù„ÙŠ:

uvicorn main:app --reload
Ø«Ù… Ø§ÙØªØ­ÙŠ Ø§Ù„Ù…ØªØµÙØ­ Ø¹Ù„Ù‰:

http://127.0.0.1:8000/docs
Ù‡ØªÙ„Ø§Ù‚ÙŠ ÙˆØ§Ø¬Ù‡Ø© ØªÙØ§Ø¹Ù„ÙŠØ© Ø¬Ù…ÙŠÙ„Ø© ØªÙ‚Ø¯Ø±ÙŠ ØªØ¬Ø±Ø¨ÙŠ Ù…Ù†Ù‡Ø§ Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„!
"""

